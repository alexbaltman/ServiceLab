# -*- mode: ruby -*-
# vi: set ft=ruby :
VAGRANTFILE_API_VERSION = "2"
required_plugins = %w( vagrant-hostmanager vagrant-openstack-provider )
required_plugins.each do |plugin|
  system "vagrant plugin install #{plugin}" unless
Vagrant.has_plugin? plugin
end
Vagrant.configure(VAGRANTFILE_API_VERSION) do |cluster|
cluster.vm.define "infra-001" do |config|
  config.hostmanager.enabled = true
  config.hostmanager.manage_host = true
  config.hostmanager.include_offline = true
  config.vm.box = "http://cis-kickstart.cisco.com/ccs-rhel-7.box"
  config.vm.provider :virtualbox do |vb, override|
    vb.customize ["modifyvm", :id, "--memory", "1024"]
  end
  config.vm.hostname = "infra-001"
  config.vm.network :private_network, ip: "192.168.100.30", mac: "000027000030"
  config.vm.provision "shell", path: "provision/infra.sh"
  config.vm.provision "file", source: "provision/ssh-config", destination: "/home/vagrant/.ssh/config"
  config.vm.provision "file", source: "id_rsa", destination: "/home/vagrant/.ssh/id_rsa"
  config.vm.provision "file", source: "hosts", destination: "/etc/hosts"
  config.vm.synced_folder "services", "/opt/ccs/services/"
end
cluster.vm.define "service-sonarqube-001" do |config|
  config.hostmanager.enabled = true
  config.hostmanager.manage_host = true
  config.hostmanager.include_offline = true
  config.vm.box = "http://cis-kickstart.cisco.com/ccs-rhel-7.box"
  config.ssh.insert_key = false
  config.ssh.forward_agent = true
  config.vm.provider :virtualbox do |vb, override|
    vb.customize ["modifyvm", :id, "--memory", "1024"]
  end
  config.vm.hostname = "service-sonarqube-001"
  config.vm.network :private_network, ip: "192.168.100.5", mac: "020027000007"
  config.vm.provision "shell", path: "provision/infra.sh"
  config.vm.provision "shell", path: "provision/node.sh"
  config.vm.provision "file", source: "provision/ssh-config", destination: "/home/vagrant/.ssh/config"
  config.vm.provision "file", source: "id_rsa", destination: "/home/vagrant/.ssh/id_rsa"
  config.vm.provision "file", source: "hosts", destination: "/etc/hosts"
end
cluster.vm.define "service-sdlc-pulp-001" do |config|
  config.hostmanager.enabled = true
  config.hostmanager.manage_host = true
  config.hostmanager.include_offline = true
  config.vm.box = "http://cis-kickstart.cisco.com/ccs-rhel-7.box"
  config.ssh.insert_key = false
  config.ssh.forward_agent = true
  config.vm.provider :virtualbox do |vb, override|
    vb.customize ["modifyvm", :id, "--memory", "1024"]
  end
  config.vm.hostname = "service-sdlc-pulp-001"
  config.vm.network :private_network, ip: "192.168.100.7", mac: "020027000007"
end
end
